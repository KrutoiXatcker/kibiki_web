{% extends "base.html" %}
{% block title %}–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏{% endblock %}
{% block content %}

<div class="card">
  <h1>üõç –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h1>

  <h2>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä</h2>
  <form method="POST"
        action="{{ url_for('admin_create_product') }}"
        class="product-form"
        enctype="multipart/form-data">

    <input type="text" name="name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" required>
    <input type="number" name="price" placeholder="–¶–µ–Ω–∞ (–∫–∏–±–∏–∫–∏)" required>

    <!-- –í–∞—Ä–∏–∞–Ω—Ç 1: URL –∫–∞—Ä—Ç–∏–Ω–∫–∏ -->
    <input type="text" name="image" placeholder="URL –∫–∞—Ä—Ç–∏–Ω–∫–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">

    <!-- –í–∞—Ä–∏–∞–Ω—Ç 2: –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª -->
    <label style="font-size:0.9rem; color:#aaa;">–∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª:</label>
    <input type="file" name="image_file" accept=".png,.jpg,.jpeg,.gif,.webp">

    <textarea name="description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"></textarea>

    <button type="submit" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å</button>
  </form>

  <hr style="margin:20px 0;">

  <h2>–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤</h2>
  <div class="product-grid">
    {% for product in products %}
    <div class="product-card">
      <img src="{{ product.image }}" alt="{{ product.name }}" style="max-width:100%; border-radius:8px;">
      <div class="product-info">
        <h4>{{ product.name }}</h4>
        <p>{{ product.description }}</p>
        <p class="price">{{ product.price }} –∫–∏–±–∏–∫–æ–≤</p>

        <form method="POST"
              action="{{ url_for('admin_edit_product', product_id=product.id) }}"
              class="edit-form"
              enctype="multipart/form-data">

          <input type="hidden" name="current_image" value="{{ product.image }}">

          <label>–ù–∞–∑–≤–∞–Ω–∏–µ</label>
          <input type="text" name="name" value="{{ product.name }}" required>

          <label>–¶–µ–Ω–∞</label>
          <input type="number" name="price" value="{{ product.price }}" required>

          <label>–¢–µ–∫—É—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</label>
          <input type="text" name="image" value="{{ product.image }}">

          <label style="font-size:0.9rem; color:#aaa;">–∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤–æ–µ:</label>
          <input type="file" name="image_file" accept=".png,.jpg,.jpeg,.gif,.webp">

          <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
          <textarea name="description">{{ product.description }}</textarea>

          <button type="submit" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </form>

        <form method="POST"
              action="{{ url_for('admin_delete_product', product_id=product.id) }}"
              onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä {{ product.name }}?');">
          <button type="submit" class="btn btn-danger" style="margin-top:10px;">üóë –£–¥–∞–ª–∏—Ç—å</button>
        </form>

      </div>
    </div>
    {% endfor %}
  </div>

  <div style="margin-top:20px;">
    <a href="{{ url_for('admin') }}" class="btn btn-secondary">‚¨Ö –ù–∞–∑–∞–¥ –≤ –∞–¥–º–∏–Ω–∫—É</a>
    <a href="{{ url_for('admin_purchases') }}" class="btn btn-info">üìä –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫</a>
  </div>
</div>

<style>
.product-form input,
.product-form textarea {
  width: 100%;
  padding: 8px;
  margin-bottom: 8px;
  border-radius: 8px;
  border: 1px solid #ccc;
  background: #1a1a1a;
  color: #fff;
}
.edit-form input,
.edit-form textarea {
  width: 100%;
  padding: 6px;
  margin: 4px 0 10px 0;
  border-radius: 6px;
  border: 1px solid #bbb;
  background: #1a1a1a;
  color: #fff;
}
.product-card {
  border: 1px solid #333;
  border-radius: 10px;
  padding: 10px;
  background: #1e1e1e;
}
.product-card h4 {
  margin-bottom: 5px;
}
.product-card .price {
  color: #4caf50;
  font-weight: bold;
  margin-bottom: 10px;
}
label {
  font-size: 0.8rem;
  color: #bbb;
}
</style>

{% endblock %}
